<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Thursday</title>

<link rel="stylesheet" href="styles/main.css">
</head>

<body>

<header class="top-header">
    <div class="header-left">
        <h2>Thursday - Programme </h2>
    </div>
    <div class="header-right">
        <img src="logo.png" alt="Company Logo">
    </div>
</header>

<div class="table-container">
    <table id="programme">
        <thead>
            <tr>
                <th>Time</th>
                <th>Event</th>
                <th>Location</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<footer>
    *Please note that pick up times for shore excursions are approximate - please see your Cruise Manager Jo for confirmed time
</footer>

<script>
const SHEET_ID = "1Y8cKLUMw_daENxzENIrJ7jPiLMbVUSf69u6P4u5e_A4";
const TAB_NAME = encodeURIComponent("Thursday");

fetch(`https://opensheet.elk.sh/${SHEET_ID}/${TAB_NAME}`)
  .then(res => res.json())
  .then(data => {
    const tbody = document.querySelector("#programme tbody");
    tbody.innerHTML = "";

    const rowCount = data.length;
    const baseFont = 22;
    const adjustedFont = Math.max(16, Math.floor(baseFont - (rowCount - 5)));
    document.querySelector("table").style.fontSize = adjustedFont + "px";

    data.forEach(row => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${row.Time || ""}</td>
        <td>${row.Event || ""}<br><small>${row.Notes || ""}</small></td>
        <td>${row.Location || ""}</td>
      `;
      tbody.appendChild(tr);
    });
  })
  .catch(err => {
    console.error("Programme load failed", err);
  });
</script>


</body>
</html>
